import{d as v,r as n,a as C,u as E,j as e}from"./index-CdOUHszh.js";import{c as l}from"./customAxios-D_Yu-ABU.js";import{L as $}from"./Loader-BZW7i5RU.js";import"./index-ngrFHoWO.js";function S(){const{work_id:r}=v(),[s,d]=n.useState(null),[g,w]=n.useState(!0),[k,f]=n.useState(null),[h,u]=n.useState(0),m=C(),{user:o,toast:i}=E(),b=async()=>{if(!o){i.info("You need to be logged in to like a work.");return}try{s.liked_by_user?(await l.delete(`/like/${r}`),d(t=>({...t,liked_by_user:!1}))):(await l.post(`/like/${r}`),d(t=>({...t,liked_by_user:!0})))}catch(t){console.error("Error liking/unliking work:",t),alert("Failed to update like status. Please try again.")}};if(n.useEffect(()=>{(async()=>{try{const{data:t}=await l.get(`/portfolio/${r}`);d(t)}catch(t){f(t.message)}finally{w(!1)}})()},[r]),g)return e.jsx("div",{className:"work-detail-container",style:{position:"relative",marginTop:"5rem",height:"100%"},children:e.jsx($,{})});if(k)return e.jsxs("div",{className:"work-detail-container error-message",children:["Error: ",k]});if(!s)return e.jsx("div",{className:"work-detail-container",children:"Work not found."});const c=[s.img_url,...s.other_image_urls||[]],x=()=>{u(t=>t===0?c.length-1:t-1)},j=()=>{u(t=>t===c.length-1?0:t+1)},N=()=>{m(-1)},y=o&&o.is_admin;return e.jsxs("div",{className:"work-detail-container",children:[e.jsxs("div",{className:"work-detail-header",children:[e.jsx("button",{className:"back-button",onClick:N,children:"← Back"}),y&&e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{className:"edit-work-button",onClick:()=>m(`/portfolio/edit/${r}`),children:"Edit"}),e.jsx("button",{className:"delete-work-button",onClick:_,children:" Delete"})]})]}),e.jsx("h1",{className:"work-title",children:s.title}),e.jsx("p",{className:"work-description",children:s.description}),e.jsxs("div",{className:"slideshow-container",children:[e.jsx("button",{className:"slideshow-btn prev",onClick:x,children:"❮"}),e.jsx("img",{src:c[h],alt:s.title,className:"slideshow-image"}),e.jsx("button",{className:"slideshow-btn next",onClick:j,children:"❯"})]}),e.jsx("div",{className:"thumbnail-grid",children:c.map((t,a)=>e.jsx("img",{src:t,alt:`Thumbnail ${a+1}`,className:`thumbnail ${a===h?"active-thumbnail":""}`,onClick:()=>u(a)},a))}),o&&e.jsxs("div",{className:"work-actions",children:[e.jsx("button",{className:`like-button ${s.liked_by_user?"liked":""}`,onClick:b,children:s.liked_by_user?"Unlike":"Like"}),e.jsx("button",{className:"like-button",onClick:p,children:"Contact us about this design"})]})]});async function p(){if(!o){i.info("You need to be logged in to order a work.");return}try{await l.post(`/portfolio/${r}/order`),i.success("Your request has been sent! We will contact you soon.")}catch(t){console.error("Error sending order request:",t),i.error("Failed to send order request. Please try again.")}}async function _(){if(!o||!o.is_admin){i.error("You are not authorized to delete this work.");return}if(window.confirm("Are you sure you want to delete this work?"))try{await l.delete(`/portfolio/${r}`),i.success("Work deleted successfully!"),m("/portfolio")}catch(a){console.error("Error deleting work:",a),i.error("Failed to delete work. Please try again.")}}}export{S as default};

import{c as y,e as k,a as E,u as S,r as h,j as s}from"./index-CCXG2qkA.js";import{c as V}from"./customAxios-IDBWETTn.js";import{L as A}from"./Loader-BJ6CDxDy.js";import"./index-ngrFHoWO.js";function P(){const e=y.c(19),[l]=k(),t=E(),{login:u}=S(),[i,g]=h.useState("pending"),[r,x]=h.useState(""),p=h.useRef(!1);let f,d;e[0]!==u||e[1]!==t||e[2]!==l?(f=()=>{const j=l.get("token");if(!j){g("error"),x("No verification token found.");return}(async()=>{if(!p.current){p.current=!0;try{const{data:c}=await V.get(`/verify-email?token=${j}`);u(c.access_token,{first_name:c.first_name,is_admin:c.is_admin,status:c.status}),g("success"),x("Your account has been successfully verified! You are now logged in."),setTimeout(()=>{t("/")},8e3)}catch(c){const v=c;console.error("Email verification failed:",v),g("error"),x(v.response?.data?.detail||"Account verification failed. Please try again or request a new link.")}}})()},d=[l,t,u],e[0]=u,e[1]=t,e[2]=l,e[3]=f,e[4]=d):(f=e[3],d=e[4]),h.useEffect(f,d);let a;e[5]!==i?(a=i==="pending"&&s.jsxs(s.Fragment,{children:[s.jsx(A,{}),s.jsx("p",{children:"Verifying your account..."})]}),e[5]=i,e[6]=a):a=e[6];let n;e[7]!==r||e[8]!==t||e[9]!==i?(n=i==="success"&&s.jsxs("div",{className:"success-message",children:[s.jsx("h2",{children:"Verification Successful!"}),s.jsx("p",{children:r}),s.jsx("button",{onClick:()=>t("/"),children:"Go to Dashboard"})]}),e[7]=r,e[8]=t,e[9]=i,e[10]=n):n=e[10];let o;e[11]!==r||e[12]!==t||e[13]!==i?(o=i==="error"&&s.jsxs("div",{className:"error-message",children:[s.jsx("h2",{children:"Verification Failed"}),s.jsx("p",{children:r}),s.jsx("button",{onClick:()=>t("/login"),children:"Go to Login"})]}),e[11]=r,e[12]=t,e[13]=i,e[14]=o):o=e[14];let m;return e[15]!==a||e[16]!==n||e[17]!==o?(m=s.jsxs("div",{className:"verify-email-container",children:[a,n,o]}),e[15]=a,e[16]=n,e[17]=o,e[18]=m):m=e[18],m}export{P as default};

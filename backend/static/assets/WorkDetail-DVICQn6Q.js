import{d as v,r as n,a as C,u as E,j as e}from"./index-Dms-G0Gk.js";import{c as l}from"./customAxios-D_Yu-ABU.js";import{L as $}from"./Loader-DezCF1lE.js";import"./index-ngrFHoWO.js";function A(){const{work_id:s}=v(),[r,d]=n.useState(null),[g,w]=n.useState(!0),[k,f]=n.useState(null),[h,u]=n.useState(0),m=C(),{user:i,toast:o}=E(),b=async()=>{if(!i){o.info("You need to be logged in to like a work.");return}try{r.liked_by_user?(await l.delete(`/like/${s}`),d(t=>({...t,liked_by_user:!1}))):(await l.post(`/like/${s}`),d(t=>({...t,liked_by_user:!0})))}catch(t){console.error("Error liking/unliking work:",t),alert("Failed to update like status. Please try again.")}};if(n.useEffect(()=>{(async()=>{try{const{data:t}=await l.get(`/portfolio/${s}`);d(t)}catch(t){f(t.message)}finally{w(!1)}})()},[s]),g)return e.jsx("div",{className:"work-detail-container",style:{position:"relative",marginTop:"5rem",height:"100%"},children:e.jsx($,{})});if(k)return e.jsxs("div",{className:"work-detail-container error-message",children:["Error: ",k]});if(!r)return e.jsx("div",{className:"work-detail-container",children:"Work not found."});const c=[r.img_url,...r.other_image_urls||[]],x=()=>{u(t=>t===0?c.length-1:t-1)},N=()=>{u(t=>t===c.length-1?0:t+1)},j=()=>{m(-1)},y=i&&i.is_admin;return e.jsxs("div",{className:"work-detail-container",children:[e.jsxs("div",{className:"work-detail-header",children:[e.jsx("button",{className:"back-button",onClick:j,children:"← Back"}),y&&e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{className:"edit-work-button",onClick:()=>m(`/portfolio/edit/${s}`),children:"Edit"}),e.jsx("button",{className:"delete-work-button",onClick:_,children:" Delete"})]})]}),e.jsxs("h1",{className:"work-title",children:[r.title," [",r.category,"]"]}),e.jsx("p",{className:"work-description",children:r.description}),e.jsxs("div",{className:"slideshow-container",children:[e.jsx("button",{className:"slideshow-btn prev",onClick:x,children:"❮"}),e.jsx("img",{src:c[h],alt:r.title,className:"slideshow-image"}),e.jsx("button",{className:"slideshow-btn next",onClick:N,children:"❯"})]}),e.jsx("div",{className:"thumbnail-grid",children:c.map((t,a)=>e.jsx("img",{src:t,alt:`Thumbnail ${a+1}`,className:`thumbnail ${a===h?"active-thumbnail":""}`,onClick:()=>u(a)},a))}),e.jsxs("div",{className:"work-actions",children:[e.jsx("button",{className:`like-button ${r.liked_by_user?"liked":""}`,onClick:b,children:r.liked_by_user?"Unlike":"Like"}),e.jsx("button",{className:"like-button",onClick:p,children:"Inquire Now"})]})]});async function p(){if(!i){o.info("You need to be logged in to inquire about a work.");return}try{await l.post(`/portfolio/${s}/order`),o.success("Your request has been sent! We will contact you soon.")}catch(t){console.error("Error sending order request:",t),o.error("Failed to send order request. Please try again.")}}async function _(){if(!i||!i.is_admin){o.error("You are not authorized to delete this work.");return}if(window.confirm("Are you sure you want to delete this work?"))try{await l.delete(`/portfolio/${s}`),o.success("Work deleted successfully!"),m("/portfolio")}catch(a){console.error("Error deleting work:",a),o.error("Failed to delete work. Please try again.")}}}export{A as default};

import{d as _,r as a,a as v,u as C,j as e}from"./index-AoGoU4kM.js";import{c}from"./customAxios-D_Yu-ABU.js";import{L as E}from"./Loader-DfnFbPMN.js";import"./index-ngrFHoWO.js";function S(){const{work_id:r}=_(),[s,d]=a.useState(null),[g,f]=a.useState(!0),[k,w]=a.useState(null),[h,u]=a.useState(0),m=v(),{user:i,toast:l}=C(),b=async()=>{if(!i){l.info("You need to be logged in to like a work.");return}try{s.liked_by_user?(await c.delete(`/like/${r}`),d(t=>({...t,liked_by_user:!1}))):(await c.post(`/like/${r}`),d(t=>({...t,liked_by_user:!0})))}catch(t){console.error("Error liking/unliking work:",t),alert("Failed to update like status. Please try again.")}};if(a.useEffect(()=>{(async()=>{try{const{data:t}=await c.get(`/portfolio/${r}`);d(t)}catch(t){w(t.message)}finally{f(!1)}})()},[r]),g)return e.jsx("div",{className:"work-detail-container",style:{position:"relative",marginTop:"5rem",height:"100%"},children:e.jsx(E,{})});if(k)return e.jsxs("div",{className:"work-detail-container error-message",children:["Error: ",k]});if(!s)return e.jsx("div",{className:"work-detail-container",children:"Work not found."});const n=[s.img_url,...s.other_image_urls||[]],x=()=>{u(t=>t===0?n.length-1:t-1)},j=()=>{u(t=>t===n.length-1?0:t+1)},N=()=>{m(-1)},p=i&&i.is_admin;return e.jsxs("div",{className:"work-detail-container",children:[e.jsxs("div",{className:"work-detail-header",children:[e.jsx("button",{className:"back-button",onClick:N,children:"← Back"}),p&&e.jsxs("div",{className:"admin-actions",children:[e.jsx("button",{className:"edit-work-button",onClick:()=>m(`/portfolio/edit/${r}`),children:"Edit"}),e.jsx("button",{className:"delete-work-button",onClick:y,children:" Delete"})]})]}),e.jsx("h1",{className:"work-title",children:s.title}),e.jsx("p",{className:"work-description",children:s.description}),e.jsxs("div",{className:"slideshow-container",children:[e.jsx("button",{className:"slideshow-btn prev",onClick:x,children:"❮"}),e.jsx("img",{src:n[h],alt:s.title,className:"slideshow-image"}),e.jsx("button",{className:"slideshow-btn next",onClick:j,children:"❯"})]}),e.jsx("div",{className:"thumbnail-grid",children:n.map((t,o)=>e.jsx("img",{src:t,alt:`Thumbnail ${o+1}`,className:`thumbnail ${o===h?"active-thumbnail":""}`,onClick:()=>u(o)},o))}),i&&e.jsx("button",{className:`like-button ${s.liked_by_user?"liked":""}`,onClick:b,children:s.liked_by_user?"Unlike":"Like"})]});async function y(){if(!i||!i.is_admin){l.error("You are not authorized to delete this work.");return}if(window.confirm("Are you sure you want to delete this work?"))try{await c.delete(`/portfolio/${r}`),l.success("Work deleted successfully!"),m("/portfolio")}catch(o){console.error("Error deleting work:",o),l.error("Failed to delete work. Please try again.")}}}export{S as default};
